---
layout:     post
title:      "Deep Dive with Skupper"
subtitle:   ""
description: "Skupper Rocks"
excerpt: "Skupper rocks again"
date:       2022-03-27
author:         "Will Cushen"
image: "/img/2018-04-11-service-mesh-vs-api-gateway/background.jpg"
published: true
tags:
    - Microservice
categories: [ Tech ]
URL: "/2022-skupper"
---

## What is Skupper

Skupper is open-source project on the rise in the Kubernetees ecosystem. It's marketed as a layer 7 service interconnect (although condensed to HTTP and gRPC protocols) that allows namesapcd-worklaods across clusters to connect as if locally.

The topopoly is relatively straightforward with the lightweight AMPq Skuppr Router brokering the traffic between namespaces. 


## Removing Silos for Hybrid Cloud

Understanding the need the Skupper means taking stock of the grwoing hybrid-cloud boom as several enterprises gripe with the intention to connect on-prmsie, private and public cloud resources. 

The connecitvity methods owever are nt limtied ot inter Kubeertes cluste with Skupper we're able to extend the fabirc to what would often be classed as "legacy" apps namely virtualzied, even mainframe-based worklaods. 

This post however, we'll confine our use case to setup conneviiy and encryption (over mTLS) between two OpenShift 4.10 clusters.

## Steps

We will use a dependent front-end/back-end stack to 

First we'll need to the latest version of the skupper CLI from https://github.com/skupperproject/skupper-cli/releases. Let's add it to our path and make it executable.

``$ curl https://skupper.io/install.sh | sh

$ sudo mv skupper /usr/local/bin 
``

2. Log into your remote cluster with oc 

3. Next we'll roll out the Skupper componetny of the Router and Controller, responsibile for creating our VAN and watching for service annotations (`skupper.io/proxy`), respectively.  

3. We will generate a link token on the namespace that is serving as the Listener in this instance.

This renders a YAML file for the Connecintg namespces on the adjoiing cluster to maintain as a secret

Once transferred over via scp or other means, we can then create that link to instantitiate the linkage between the two clusters

4. It's important to know that once clusters have formed a mesh the traffic will be completely bi-direcitonal that if the originating namespace (where the token was create ditnially) goes down; the network between those remaining particpating clusterd will continue to be active.  

```
skupper link status
```

Get Skupper, then
get into appropriate namespace on each cluster
then on each
skupper init
On one side
skupper token create ~/secret.yaml

skupper link create ~/secret.yaml
skupper link status
skupper status
Lab:
oc new-app --as-deployment-config=false --name hello-world-frontend --docker-image quay.io/skupper/hello-world-frontend
Dev:
oc new-app --as-deployment-config=false --name hello-world-backend --docker-image quay.io/skupper/hello-world-backend
Lab and Dev:
oc expose service/hello-world-frontend
skupper expose deployment/hello-world-backend --port 80
